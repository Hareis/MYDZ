using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Top.Api;
using Top.Api.Request;
using Top.Api.Response;
using MYDZ.Entity.Goods;
using Top.Api.Util;

namespace MYDZ.Business.TB_Logic.Goods
{
    public class SetGoods
    {
        /// <summary>
        /// 下架商品
        /// </summary>
        /// <param name="SessionKey"></param>
        /// <param name="GoodId"></param>
        public void UnShelve(string SessionKey, long GoodId)
        {
            ITopClient client = new DefaultTopClient(StaticSystemConfig.soft.ApiURL, StaticSystemConfig.soft.AppKey, StaticSystemConfig.soft.AppSecret, "json");
            ItemUpdateDelistingRequest req = new ItemUpdateDelistingRequest();
            req.NumIid = GoodId;
            ItemUpdateDelistingResponse response = client.Execute(req, SessionKey);
        }

        /// <summary>
        /// 更新商品信息
        /// </summary>
        public bool UpdateGood(string sessionKey, ItemUpdate goods, out string ErrorMsg)
        {
            ErrorMsg = null;
            ITopClient client = new DefaultTopClient(StaticSystemConfig.soft.ApiURL, StaticSystemConfig.soft.AppKey, StaticSystemConfig.soft.AppSecret, "json");
            ItemUpdateRequest req = new ItemUpdateRequest();
            if (goods.NumIid == null) {
                ErrorMsg = "商品ID不能为空"; 
                return false; 
            }else
            {
                req.NumIid = goods.NumIid;
            }
            if (goods.Cid != null)
            {
                req.Cid = goods.Cid;
            }
            if (goods.Props != null)
            {
                req.Props = goods.Props;
            }
            if (goods.Num != null)
            {
                req.Num = goods.Num;
            }
            if (goods.Price != null)
            {
                req.Price = goods.Price;
            }
            if (goods.Title != null)
            {
                req.Title = goods.Title;
            }
            if (goods.Desc != null)
            {
                req.Desc = goods.Desc;
            }
            if (goods.LocationState != null)
            {
                req.LocationState = goods.LocationState;
            }
            if (goods.LocationCity != null)
            {
                req.LocationCity = goods.LocationCity;
            }
            if (goods.PostFee != null)
            {
                req.PostFee = goods.PostFee;
            }
            if (goods.ExpressFee != null)
            {
                req.ExpressFee = goods.ExpressFee;
            }
            if (goods.EmsFee != null)
            {
                req.EmsFee = goods.EmsFee;
            }
            if (goods.ListTime != null)
            {
                DateTime dateTime = DateTime.Parse("2000-01-01 00:00:00");
                req.ListTime = dateTime;
            }
            if (goods.Cid != null)
            {
                req.Increment = goods.Increment;
            }
            if (goods.Image != null)
            {
                //括号中中填文件路径
                FileItem fItem = new FileItem(goods.Image[0].ToString());
                req.Image = fItem;
            }
            if (goods.StuffStatus != null)
            {
                req.StuffStatus = goods.StuffStatus;
            }
            if (goods.AuctionPoint != null)
            {
                req.AuctionPoint = goods.AuctionPoint;
            }
            if (goods.PropertyAlias != null)
            {
                req.PropertyAlias = goods.PropertyAlias;
            }
            if (goods.InputPids != null)
            {
                req.InputPids = goods.InputPids;
            }
            if (goods.SkuQuantities != null)
            {
                req.SkuQuantities = goods.SkuQuantities;
            }
            if (goods.SkuPrices != null)
            {
                req.SkuPrices = goods.SkuPrices;
            }
            if (goods.SkuProperties != null)
            {
                req.SkuProperties = "pid:vid;pid:vid";
            }
            if (goods.SellerCids != null)
            {
                req.SellerCids = goods.SellerCids;
            }
            if (goods.PostageId != null)
            {
                req.PostageId = goods.PostageId;
            }
            if (goods.OuterId != null)
            {
                req.OuterId = goods.OuterId;
            }
            if (goods.ProductId != null)
            {
                req.ProductId = goods.ProductId;
            }
            if (goods.PicPath != null)
            {
                req.PicPath = goods.PicPath;
            }
            if (goods.AutoFill != null)
            {
                req.AutoFill = goods.AutoFill;
            }
            if (goods.SkuOuterIds != null)
            {
                req.SkuOuterIds = goods.SkuOuterIds;
            }
            if (goods.IsTaobao != null)
            {
                req.IsTaobao = goods.IsTaobao;
            }
            if (goods.IsEx != null)
            {
                req.IsEx = goods.IsEx;
            }
            if (goods.Is3D != null)
            {
                req.Is3D = goods.Is3D;
            }
            if (goods.IsReplaceSku != null)
            {
                req.IsReplaceSku = goods.IsReplaceSku;
            }
            if (goods.InputStr != null)
            {
                req.InputStr = goods.InputStr;
            }
            if (goods.Lang != null)
            {
                req.Lang = goods.Lang;
            }
            if (goods.HasDiscount != null)
            {
                req.HasDiscount = goods.HasDiscount;
            }
            if (goods.HasShowcase != null)
            {
                req.HasShowcase = goods.HasShowcase;
            }
            if (goods.ApproveStatus != null)
            {
                req.ApproveStatus = goods.ApproveStatus;
            }
            if (goods.FreightPayer != null)
            {
                req.FreightPayer = goods.FreightPayer;
            }
            if (goods.ValidThru != null)
            {
                req.ValidThru = goods.ValidThru;
            }
            if (goods.HasInvoice != null)
                req.HasInvoice = goods.HasInvoice;
            if (goods.HasWarranty != null)
                req.HasWarranty = goods.HasWarranty;
            if (goods.AfterSaleId != null)
                req.AfterSaleId = goods.AfterSaleId;
            if (goods.SellPromise != null)
                req.SellPromise = goods.SellPromise;
            if (goods.CodPostageId != null)
                req.CodPostageId = goods.CodPostageId;
            if (goods.IsLightningConsignment != null)
                req.IsLightningConsignment = goods.IsLightningConsignment;
            if (goods.Weight != null)
                req.Weight = goods.Weight;
            if (goods.IsXinpin != null)
                req.IsXinpin = goods.IsXinpin;
            if (goods.SubStock != null)
                req.SubStock = goods.SubStock;
            if (goods.FoodSecurityPrdLicenseNo != null)
                req.FoodSecurityPrdLicenseNo = goods.FoodSecurityPrdLicenseNo;
            if (goods.FoodSecurityDesignCode != null)
                req.FoodSecurityDesignCode = goods.FoodSecurityDesignCode;
            if (goods.FoodSecurityFactory != null)
                req.FoodSecurityFactory = goods.FoodSecurityFactory;
            if (goods.FoodSecurityFactorySite != null)
                req.FoodSecurityFactorySite = goods.FoodSecurityFactorySite;
            if (goods.FoodSecurityContact != null)
                req.FoodSecurityContact = goods.FoodSecurityContact;
            if (goods.FoodSecurityMix != null)
                req.FoodSecurityMix = goods.FoodSecurityMix;
            if (goods.FoodSecurityPlanStorage != null)
                req.FoodSecurityPlanStorage = goods.FoodSecurityPlanStorage;
            if (goods.FoodSecurityPeriod != null)
                req.FoodSecurityPeriod = goods.FoodSecurityPeriod;
            if (goods.FoodSecurityFoodAdditive != null)
                req.FoodSecurityFoodAdditive = goods.FoodSecurityFoodAdditive;
            if (goods.FoodSecuritySupplier != null)
                req.FoodSecuritySupplier = goods.FoodSecuritySupplier;
            if (goods.FoodSecurityProductDateStart != null)
                req.FoodSecurityProductDateStart = goods.FoodSecurityProductDateStart;
            if (goods.FoodSecurityProductDateEnd != null)
                req.FoodSecurityProductDateEnd = goods.FoodSecurityProductDateEnd;
            if (goods.FoodSecurityStockDateStart != null)
                req.FoodSecurityStockDateStart = goods.FoodSecurityStockDateStart;
            if (goods.FoodSecurityStockDateEnd != null)
                req.FoodSecurityStockDateEnd = goods.FoodSecurityStockDateEnd;
            if (goods.SkuSpecIds != null)
                req.SkuSpecIds = goods.SkuSpecIds;
            if (goods.ItemSize != null)
                req.ItemSize = goods.ItemSize;
            if (goods.ItemWeight != null)
                req.ItemWeight = goods.ItemWeight;
            if (goods.ChangeProp != null)
                req.ChangeProp = goods.ChangeProp;
            if (goods.SellPoint != null)
                req.SellPoint = goods.SellPoint;
            if (goods.DescModules != null)
                req.DescModules = goods.DescModules;
            if (goods.FoodSecurityHealthProductNo != null)
                req.FoodSecurityHealthProductNo = goods.FoodSecurityHealthProductNo;
            if (goods.Barcode != null)
                req.Barcode = goods.Barcode;
            if (goods.SkuBarcode != null)
                req.SkuBarcode = goods.SkuBarcode;
            if (goods.Newprepay != null)
                req.Newprepay = goods.Newprepay;
            if (goods.IsOffline != null)
                req.IsOffline = goods.IsOffline;
            if (goods.ChaoshiExtendsInfo != null)
                req.ChaoshiExtendsInfo = goods.ChaoshiExtendsInfo;
            if (goods.SkuHdLength != null)
                req.SkuHdLength = goods.SkuHdLength;
            if (goods.SkuHdHeight != null)
                req.SkuHdHeight = goods.SkuHdHeight;
            if (goods.SkuHdLampQuantity != null)
                req.SkuHdLampQuantity = goods.SkuHdLampQuantity;
            if (goods.Qualification != null)
                req.Qualification = goods.Qualification;
            if (goods.O2oBindService != null)
                req.O2oBindService = goods.O2oBindService;
            if (goods.Ignorewarning != null)
                req.Ignorewarning = goods.Ignorewarning;
            if (goods.EmptyFields != null)
                req.EmptyFields = goods.EmptyFields;
            if (goods.LocalityLifeExpirydate != null)
                req.LocalityLifeExpirydate = goods.LocalityLifeExpirydate;
            if (goods.LocalityLifeNetworkId != null)
                req.LocalityLifeNetworkId = goods.LocalityLifeNetworkId;
            if (goods.LocalityLifeMerchant != null)
                req.LocalityLifeMerchant = goods.LocalityLifeMerchant;
            if (goods.LocalityLifeVerification != null)
                req.LocalityLifeVerification = goods.LocalityLifeVerification;
            if (goods.LocalityLifeRefundRatio != null)
                req.LocalityLifeRefundRatio = goods.LocalityLifeRefundRatio;
            if (goods.LocalityLifeChooseLogis != null)
                req.LocalityLifeChooseLogis = goods.LocalityLifeChooseLogis;
            if (goods.LocalityLifeOnsaleAutoRefundRatio != null)
                req.LocalityLifeOnsaleAutoRefundRatio = goods.LocalityLifeOnsaleAutoRefundRatio;
            if (goods.LocalityLifeRefundmafee != null)
                req.LocalityLifeRefundmafee = goods.LocalityLifeRefundmafee;
            if (goods.ScenicTicketPayWay != null)
                req.ScenicTicketPayWay = goods.ScenicTicketPayWay;
            if (goods.ScenicTicketBookCost != null)
                req.ScenicTicketBookCost = goods.ScenicTicketBookCost;
            if (goods.PaimaiInfoMode != null)
                req.PaimaiInfoMode = goods.PaimaiInfoMode;
            if (goods.PaimaiInfoDeposit != null)
                req.PaimaiInfoDeposit = goods.PaimaiInfoDeposit;
            if (goods.PaimaiInfoInterval != null)
                req.PaimaiInfoInterval = goods.PaimaiInfoInterval;
            if (goods.PaimaiInfoReserve != null)
                req.PaimaiInfoReserve = goods.PaimaiInfoReserve;
            if (goods.PaimaiInfoValidHour != null)
                req.PaimaiInfoValidHour = goods.PaimaiInfoValidHour;
            if (goods.PaimaiInfoValidMinute != null)
                req.PaimaiInfoValidMinute = goods.PaimaiInfoValidMinute;
            if (goods.GlobalStockType != null)
                req.GlobalStockType = goods.GlobalStockType;
            if (goods.GlobalStockCountry != null)
                req.GlobalStockCountry = goods.GlobalStockCountry;
            ItemUpdateResponse response = client.Execute(req, sessionKey);
            if (!response.IsError)
            {
                return true;
            }
            else {
                ErrorMsg = response.SubErrMsg;
                return false;
            }
        }
  
        
    }
}
